<form class="form-container" [formGroup]="formGroup" [class.loading-active]="isLoading" #formContainer id="disable-lastpass-search">

  <div class="spinner-container">
    <md-spinner class="mat-accent" *ngIf="isLoading"></md-spinner>
  </div>

  <div class="form-actions">
    <ng-container *ngIf="isDialog">
      <button md-raised-button type="button" class="mat-accent" [md-dialog-close]="facilitator" [disabled]="!formGroup.valid || facilitator.affiliate.sfId == ''"> Save </button>
      <button md-raised-button type="button" [md-dialog-close]="false"> Cancel </button>
    </ng-container>

    <ng-container *ngIf="!isDialog">
      <button md-raised-button type="button" class="mat-accent" (click)="onSave()" [disabled]="!formGroup.valid || facilitator.affiliate.sfId == ''"> Save </button>
      <button md-raised-button type="button" (click)="location.back()"> Cancel </button>
    </ng-container>
  </div>

  <div class="form-header">
    <h3> Facilitator Form </h3>
  </div>

  <div class="input-item">
    <md-input-container>
      <input type="text" mdInput [mdAutocomplete]="auto" placeholder="Email" [(ngModel)]="facilitator.email" formControlName="email"
        required>
      <div class="search-spinner-container">
        <md-spinner class="mat-accent" *ngIf="isSearching"></md-spinner>
      </div>
    </md-input-container>

    <md-autocomplete #auto="mdAutocomplete" [displayWith]="displayFn">
      <md-option *ngFor="let f of facilitatorsOpts" [value]="f.email" (onSelectionChange)="onSelectFacilitator(f)">
        {{ f.email }}
      </md-option>
    </md-autocomplete>
  </div>

  <div class="input-item">
    <md-input-container>
      <input mdInput [(ngModel)]="facilitator.firstName" placeholder="First Name" formControlName="firstName" required>
    </md-input-container>
  </div>

  <div class="input-item">
    <md-input-container>
      <input mdInput [(ngModel)]="facilitator.lastName" placeholder="Last Name" formControlName="lastName" required>
    </md-input-container>
  </div>

  <div class="input-item">
    <md-input-container>
      <input mdInput [(ngModel)]="facilitator.title" formControlName="title" placeholder="Title">
    </md-input-container>
  </div>

  <div class="input-item">
    <div class="facilitator-img">
      <img src="{{ facilitator.photo }}">
    </div>

    <md-input-container>
      <input mdInput [(ngModel)]="facilitator.photo" formControlName="photo" placeholder="Photograph URL">
    </md-input-container>
  </div>

  <div class="input-item">
    <app-affiliate-lookup (onSelect)="onSelectAffiliate($event)" [affiliate]="facilitator.affiliate"></app-affiliate-lookup>
  </div>

  <div class="input-item">
    <p class="mat-caption">*Facilitators must be assigned an affiliate to change their role type.</p>
    <md-select [(ngModel)]="facilitator.role" placeholder="Role" formControlName="role">
      <md-option *ngFor="let role of roles" [value]="role"> {{ role }}</md-option>
    </md-select>
  </div>

  <div class="form-actions">
    <ng-container *ngIf="isDialog">
      <button md-raised-button type="button" class="mat-accent" [md-dialog-close]="facilitator" [disabled]="!formGroup.valid || facilitator.affiliate.sfId == ''"> Save </button>
      <button md-raised-button type="button" [md-dialog-close]="false"> Cancel </button>
    </ng-container>

    <ng-container *ngIf="!isDialog">
      <button md-raised-button type="button" class="mat-accent" (click)="onSave()" [disabled]="!formGroup.valid || facilitator.affiliate.sfId == ''"> Save </button>
      <button md-raised-button type="button" (click)="location.back()"> Cancel </button>
    </ng-container>
  </div>

</form>